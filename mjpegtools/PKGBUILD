#
# Chakra Packages for Chakra, part of chakra-project.org
#
# maintainer (i686): Phil Miller <philm[at]chakra-project[dog]org>
# maintainer (x86_64): Manuel Tortosa <manutortosa[at]chakra-project[dot]org>

pkgname=mjpegtools
pkgver=2.0.0
pkgrel=1
pkgdesc="Set of tools that can do recording of videos and playback, simple cut-and-paste editing and the MPEG compression of audio and video"
arch=(i686 x86_64)
license=('GPL')
url="http://mjpeg.sourceforge.net/"
depends=('libjpeg>=8' 'libpng>=1.4.0' 'sdl' 'gcc-libs' 'libdv')
options=('!makeflags' '!libtool')
source=(http://downloads.sourceforge.net/sourceforge/mjpeg/${pkgname}-${pkgver}.tar.gz)
        #mjpegtools-1.9.0-glibc-2.10.patch
        #png2yuv-fix-memleak.patch)
md5sums=('903e1e3b967eebcc5fe5626d7517dc46')
         #'b8ae66237d83be533db8eea166fd3357'
         #'39e1def8fb0f7c58a217b22dc251a86a')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  sed -i -e '/ARCHFLAGS=/s:=.*:=:' configure
  #patch -Np1 -i "$srcdir/mjpegtools-1.9.0-glibc-2.10.patch"
  #patch -Np1 -i "${srcdir}/png2yuv-fix-memleak.patch"
  #patch -Np0 -i "${srcdir}/mjpegtools-1.9.0-jpeg-7.patch"
  ./configure --prefix=/usr --enable-largefile
  make
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  make DESTDIR="${pkgdir}" install
  install -m644 mpeg2enc/mpeg2syntaxcodes.h "${pkgdir}/usr/include/mjpegtools/mpeg2enc/"
}
