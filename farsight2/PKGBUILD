#
# Platform Packages for Chakra, part of chakra-project.org
#
# maintainer (i686): Phil Miller <philm[at]chakra-project[dog]org>
# maintainer (x86_64): Manuel Tortosa <manutortosa[at]chakra-project[dot]org>

pkgname=farsight2
pkgver=0.0.22
pkgrel=1
pkgdesc="Audio/Video conference software for Instant Messengers"
arch=('i686' 'x86_64')
url="http://farsight.freedesktop.org"
license=('LGPL')
depends=('libnice>=0.0.11' 'gstreamer0.10-base-plugins>=0.10.28' 'gstreamer0.10-python>=0.10.18' 'python2' 'pygobject>=2.16.0')
optdepends=('gstreamer0.10-good: for RTP plugin'
            'gstreamer0.10-bad: for RTP plugin')
options=('!libtool' '!emptydirs')
source=(http://farsight.freedesktop.org/releases/${pkgname}/${pkgname}-${pkgver}.tar.gz)
md5sums=('e1f540cf3ebab06c3d7db1f46b44ac88')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  sed -i -e 's#python-config#python2-config#' python/Makefile.in
  # this makefile is broken
  sed -i -e 's#        #        #' docs/libs/Makefile.in

  ./configure --prefix=/usr \
      --with-package-name='Chakra Linux farsight2 package' \
      --with-package-origin='http://chakra-project.org' \
      --disable-static -disable-valgrind --disable-debug
  make
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  make DESTDIR=${pkgdir} install || return 1
}
