# Platform Packages for Chakra, part of chakra-project.org
#
# maintainer abveritas@chakra-project.org

pkgname=enblend-enfuse
pkgver=4.0
pkgrel=5
pkgdesc="intelligent blend tool for overlapping picture"
arch=("x86_64")
license=('GPL')
url="http://enblend.sourceforge.net"
depends=('openexr' 'glew>=1.9' 'libxmi' 'freeglut' 'libgl' 'lcms' 'texinfo' 'libpng' 'boost-libs')
makedepends=('boost' 'mesa')
replaces=('enblend')
conflicts=('enblend')
provides=('enblend')
install=${pkgname}.install
source=("http://downloads.sourceforge.net/sourceforge/enblend/${pkgname}-${pkgver}.tar.gz"
        'libpng-1.4.patch'
        'enblend-4.0-libpng15.patch')
md5sums=('2e7c950061e0085fd75d94576130250f'
         'a39df8dd32ccfa020dea2ea388642575'
         'defa21aa09b82d2b2e4913acb9ad0722')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}-753b534c819d"
  patch -p1 -i ../libpng-1.4.patch
  patch -p0 -i ../enblend-4.0-libpng15.patch
  LIBS="-lboost_system" ./configure --prefix=/usr./configure --prefix=/usr
  make
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}-753b534c819d"
  make DESTDIR="${pkgdir}" install
  install -D -m644 doc/enblend.info "${pkgdir}/usr/share/info/enblend.info"
  install -D -m644 doc/enfuse.info "${pkgdir}/usr/share/info/enfuse.info"
}
