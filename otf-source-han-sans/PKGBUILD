pkgbase=otf-source-han-sans
pkgname=($pkgbase $pkgbase-k $pkgbase-sc $pkgbase-tc ${pkgbase/otf/otc})
pkgver=1.003
pkgrel=1
pkgdesc='Adobe Source Han Sans - A set of Pan-CJK fonts designed to complement Source Sans Pro'
arch=('any')
license=('custom:OFL')
url='http://sourceforge.net/adobe/source-han-sans'
depends=('fontconfig')
install="${pkgbase}.install"
source=()

_commit=c9f53baf86fef8bb53a396b765f1477875366816
_weights=("Bold" "ExtraLight" "Heavy" "Light" "Medium" "Normal" "Regular")
_font=("OTC SourceHanSans ttc ${pkgbase/otf/otc} 44-source-han-sans-otc.conf"
       "OTF/Japanese SourceHanSans otf $pkgbase 44-source-han-sans.conf"
       "OTF/Korean SourceHanSansK otf $pkgbase-k 44-source-han-sans-k.conf"
       "OTF/SimplifiedChinese SourceHanSansSC otf $pkgbase-sc 44-source-han-sans-sc.conf"
       "OTF/TraditionalChinese SourceHanSansTC otf $pkgbase-tc 44-source-han-sans-tc.conf")

_pkgdesc=("Adobe Source Han Sans - Pan-CJK OpenType/CFF Collection fonts"
          "Adobe Source Han Sans - Japanese OpenType/CFF fonts"
          "Adobe Source Han Sans - Korean OpenType/CFF fonts"
          "Adobe Source Han Sans - Simplified Chinese OpenType/CFF fonts"
          "Adobe Source Han Sans - Traditional Chinese OpenType/CFF fonts")

_replace=("" "$pkgbase-jp=1.000" "$pkgbase-kr=1.000" "$pkgbase-cn=1.000" "$pkgbase-twhk=1.000")

for((idx=0;idx<${#_font[@]};idx++)); do
    _info=${_font[$idx]}
    _args=($_info)
    source+=("${_args[4]}")
    for w in "${_weights[@]}"; do
        source+=("https://github.com/adobe-fonts/source-han-sans/raw/$_commit/${_args[0]}/${_args[1]}-${w}.${_args[2]}")
    done
    eval "function package_${_args[3]}() { _package $idx; }"
done

function _package {
    cd "$srcdir"
    idx=$1

    _info=${_font[$idx]}
    _args=($_info)
    _fontconfig_filename=${_args[4]}
    pkgdesc=${_pkgdesc[$idx]}
    if [[ "${_replace[$idx]}" != "" ]]; then
         replaces=("${_replace[$idx]}")
         conflicts=("${_replace[$idx]}")
    fi

    # Prepare destination directory
    install -dm755 "$pkgdir/usr/share/fonts/$pkgbase"

    for w in "${_weights[@]}"; do
	font="${_args[1]}-${w}.${_args[2]}"
        install -m644 "$font" "$pkgdir/usr/share/fonts/$pkgbase"
    done

    # Install fontconfig fix
    install -d "$pkgdir/etc/fonts/conf.d"
    install -Dm644 "$srcdir/$_fontconfig_filename" "$pkgdir/etc/fonts/conf.avail/$_fontconfig_filename"
    ln -s ../conf.avail/$_fontconfig_filename "$pkgdir/etc/fonts/conf.d/$_fontconfig_filename"
}

sha256sums=('71397a72a3b0738db191db2b924eed7804e8fe83af17582505e104e9eedc0da7'
            'eb094f0bfd247571e2cac031d1e2c3244f9d22bfefc8f269abb030c779f32746'
            'c56067ed820610f4bbbe76437876fdaa4abfa1e0809313912d7017dd18b27c05'
            'f9300cb00e327f3aeeab382d888e8a0846cd36dd7c1fdf7607967b6c913a0491'
            '0db4e8d6f597e9db7d8ee99c281ada81b521c55efad573a757ebd83825ed4109'
            '0ef14409ad08aaabe3b99f73f2003d7ebe5ef7300ee867a804a11f0e9493c65c'
            'c1c869adfebe0ef1f997be52f0c939e6220e7eba3a2f7428bb1cb16461e90ad7'
            'e2ee6ef43d0515148c4f38c8e44f1048597461d2734bbcda6e92b1008f4a6a95'
            '18225126927cc7814fe92a3e72332685f78598afbe4ea69a2be84af825dbd1e6'
            '2193ef1a149452b478cf18126540694fea05be90ee2a3b0a8cb638c032873d5b'
            'ac931bf2259009d4d0d853cbe9f84ee7220fd765ae1bd96dca642b854667ca44'
            'a510490d1a320476cb57c008b73f32ba485a0359f39bd9b1c07fac77295c32a7'
            '210f684c152898ebec9a23b9ab872b3aedc5606e78b9c7959a95caf5bbe16bb5'
            'bd1b6a03932778451eadb0d53ba260dbc758336fa1740ae28ee1ac31f16a0562'
            '0d48d30e73384c31f2ed30b4079d72d9fc26441bc34c37f9871392c5d3ed7d3c'
            'cc6f7fadb6c39cbb6f31073294c9344efea1911647e3309001b358b07d45ae4c'
            'd975db0d9df4c71267cbb78bdb0c2ae526666162fd256c326041562a83d2b758'
            '669686951a6459bc1c5fa192305af0637b44ae981cf2559977a4df1036218d94'
            '0bd1d85dce0a20bf0784f73b329b044e90efca9f09e3c0a8bf84edfbd7c940fc'
            '47a451633a89f05b6f3443ef76f2997d1062a32a58fb4d4c199949a604a80459'
            '8797bbbb91a98528228ccf329d758a5ca7ab878137fe5b4bd004b5bc0888a0e2'
            '6b4d0cc90d0cb08f224858071a42b2d19110a1795e1228eaf4c26851c14a4672'
            '25d2d6f9573087e168c5e918c7305b0b7e8ee604e7c8e693f583263e2ae7b54b'
            '6a03c6d07afe4cb77df5d2f473b18f038f34f85a8df91c3f9cbc29d88ce7993c'
            '140db21c2ff0966c1ba52f2945d8b368516f898abddad28a817849337aa7f917'
            'd7bc13bb732b33ca1a6360be68b2f97e3f43b0921a9f32bccfaa1b66d47564d9'
            'efff6d56beed60c886d207d2127e6d0f1789412a20814b5a57e2b0529c42b24b'
            'd0782042edf6b9609e72536943022a9a1e374dd106d6b37d5f9243bb7a7095b0'
            '767056df7f6989310dd7550adbde90fd4f915a4eb5fc6247d49ccf6c1c45f1b0'
            '769205402a607650f4b3eb4ba3133c16c9831e80b0b9ba19d176ffd33e286cc5'
            '8e4c044745b0d6f833cc81f493fa7c8144c454b900e42947e619e87e95db1076'
            '85851c938af26439769bb95c183f89d90e3019a3fbd5a210bfaa14f651c43375'
            '12c80ff78aaa29574183038527a191ff4f4948a237e923c0a95dec4c22b200d0'
            '93b7965d37466196b93c1e28c07ff8abd4d94d76d4c7bcf131670bc1935395c4'
            'e0b23c8c47c4abb404221d190cf61c5b6d54e55628e3493c4185ec0840d30ea0'
            '59fa4a70c94c0710f2761ccb745b96cbf8be35155546a1e00b0c410492370888'
            '3015ae038a1cbb8db4988e9e9228772427fa77e8ebb66a2137326adfba9834cf'
            'a40a744ef02d01973d3abf19b21626f72fa0629f914cecf39e7d0ce41cafae0a'
            'cfce348bd7c0c5229da41aba57cb8e352e53bbbcf3221b339c88214ce12fd8bf'
            '0d70de624d02f867cf18d8be0c691dbd0b268911f7e20a34e9d40b23ad654f77')
