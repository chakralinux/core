#
# Chakra Packages for Chakra, part of chakra-project.org
#
# maintainer (i686): Phil Miller <philm[at]chakra-project[dog]org>
# maintainer (x86_64): Manuel Tortosa <manutortosa[at]chakra-project[dot]org>

#
# package info
#
pkgname=libqzeitgeist
pkgver=20110327
pkgrel=1
pkgdesc="Qt interface for Zeitgeist"
url="http://gitorious.org/kde-zeitgeist/libqzeitgeist/"
license="GPL"
arch=('i686' 'x86_64')
depends=('qt>=4.7.2')
makedepends=('cmake')
options=('sign')
source=("http://chakra-project.org/sources/${pkgname}/${pkgname}-${pkgver}-${pkgrel}.tar.xz")
md5sums=('218da21cfad9119e4c0410519c02b0ac')
        
groups=('kde-uninstall')

# create tarball: source PKGBUILD && mksource

mksource() {
	  rm -vRf ${pkgname}
	  git clone git://gitorious.org/kde-zeitgeist/${pkgname}.git
	  rm -vRf ${pkgname}/.git
	  pushd ${pkgname}
	  popd
	  tar -cvJf ${pkgname}-${pkgver}-${pkgrel}.tar.xz ${pkgname}/*
	  md5sum ${pkgname}-${pkgver}-${pkgrel}.tar.xz
}

#
# build function
#
build()
{
        cd "${srcdir}/$pkgname"

	cmake . -DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_SKIP_RPATH=ON \
		-DCMAKE_{SHARED,MODULE,EXE}_LINKER_FLAGS='-Wl,--no-undefined -Wl,--as-needed'

	msg "Starting make..."
	make || return 1
}

package()
{
        cd "${srcdir}/$pkgname"
	msg "Make successful, installing..."
	make DESTDIR=$startdir/pkg install
}