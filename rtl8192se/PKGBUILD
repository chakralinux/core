#
# Chakra Packages for Chakra, part of chakra-project.org
#
# maintainer (i686): Phil Miller <philm[at]chakra-project[dog]org>
# maintainer (x86_64): Manuel Tortosa <manutortosa[at]chakra-project[dot]org>

# include global config
source ../_buildscripts/${current_repo}-${_arch}-cfg.conf

# Find the kernel name inside the chroot
_kernver=`pacman -Qf kernel26 | cut -c10-15 | sed 's/kernel26 //g'`-CHAKRA

pkgname=rtl8192se
pkgver=2.6.0018.1025.2010
pkgrel=6cd
pkgdesc="Drivers for Realtek 8192SE wireless chipset"
license="GPL"
depends=('kernel26-headers' 'kernel26>=2.6.39' 'kernel26<2.6.40')
source=("http://www.nd.edu/~pbui/scratch/aur/${pkgname}_linux_${pkgver}.tar.gz")
arch=('i686' 'x86_64')
url="http://www.realtek.com.tw/"
install="${pkgname}.install"

build() {
    cd ${srcdir}/${pkgname}_linux_${pkgver}

    #sed -i 's/-DENABLE_LPS//' HAL/rtl8192/Makefile || return 1
    #sed -i 's/-DENABLE_LPS//' HAL/rtl8192/*/Makefile || return 1

    sed \
      -e  "s/$(shell uname -r)/${_kernver}/g" \
      -i Makefile

    make || return 1

    mkdir -p ${pkgdir}/lib/firmware
    cp -rf firmware/RTL8192SE ${pkgdir}/lib/firmware
    mkdir -p ${pkgdir}/lib/modules/${_kernver}/kernel/drivers/net/wireless/
    cp -f HAL/rtl8192/r8192se_pci.ko ${pkgdir}/lib/modules/${_kernver}/kernel/drivers/net/wireless/
} 

md5sums=('a79ce9fd5a7e3d2cedd397cc0b5ae1de')
